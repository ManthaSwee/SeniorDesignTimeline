<!DOCTYPE HTML>
<html>
  <head>
    <script src="js/build.three.js"></script>
    <script src="js/trackballControls.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/3DSetup.js"></script>
<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/styles.css">
  </head>
  <body>
<div id="fb-root"></div>
  <script>
    var friendlist = {};

    window.fbAsyncInit = function() {
    FB.init({
      appId      : '649482025087509',
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });

    FB.Event.subscribe('auth.authResponseChange', function(response) {
      if (response.status === 'connected') {
        testAPI();
      } else if (response.status === 'not_authorized') {
        FB.login();
      } else {
        FB.login();
      }
    });
    };

    // Load the SDK asynchronously
    (function(d){
     var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement('script'); js.id = id; js.async = true;
     js.src = "//connect.facebook.net/en_US/all.js";
     ref.parentNode.insertBefore(js, ref);
    }(document));

    // Here we run a very simple test of the Graph API after login is successful. 
    // This testAPI() function is only called in those cases. 
    function testAPI() {
      console.log('Welcome!  Fetching your information.... ');
      FB.api('/me', function(response) {
        console.log('Good to see you, ' + response.name + '.');
        getFriends();
        getProfilePicture(response.id);
      });
    }

    function getFriends() {
     // First get the list of friends for this user with the Graph API
     FB.api('/me/friends', function(response) {
        for(var i = 0; i < response.data.length; i++){
          friendlist[response.data[i].name] = response.data[i].id;
          $('#friendlist').append("<li><input type=\"checkbox\">" + response.data[i].name + "</li>");
        }
       });
     }

     function getProfilePicture(id){
      var image = "<img src=\'https://graph.facebook.com/" + id + "/picture\' />";
      $('#user').prepend(image);
      console.log(image);
     }
  </script>
    <script src="js/tools.js"></script>
    <div id="container">
      <canvas id="network"></canvas>
    </div>
    <footer>
      <div id="options">
        <button class="nobar" id="a">A</button>
        <button class="bar" id="b">B</button>
        <button class="bar" id="c">C</button>
      </div>
      <div id="logo"></div>
      <div id="user">
        <div id="user-info">
          Samantha Swee Merritt
        </div>
      </div>
      <div id="viewport">
        <div id="searchbar">
          <div id="mag-glass"></div>
          <input class="box" type="text" onkeyup="filter(this)"></input>
          <script>
            function filter(element) {
                var value = $(element).val();

                $("#friendlist > li").each(function() {
                    if ($(this).text().search(value) > -1) {
                        $(this).show();
                    }
                    else {
                        $(this).hide();
                    }
                });
            }
          </script>
        </div>
        <canvas id="small-view-3D"></canvas>
        <ul id="friendlist"></ul>
      </div>
    </footer>
  </body>
</html>